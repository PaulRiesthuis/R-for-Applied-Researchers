dat_orignal$Occupation  = factor(dat_orignal$Occupation, levels=c("Judge", "Prosecutor", "Lawyer", "Parelegal", "Other"))
library(readxl)
library(dplyr)
library(tidyverse)
library("data.table")
dat_orignal <- read_xlsx("Raw_Data.xlsx",  skip = 1)
dat_orignal <- as.data.frame(dat_orignal)
setnames(dat_orignal, old = "Wat is de achtergrond van uw huidige beroep? - Selected Choice", new= "Background")
setnames(dat_orignal, old = "Wat is uw huidige beroep? - Selected Choice", new =  "Occupation")
setnames(dat_orignal,old= "Geslacht - Selected Choice", new= "Gender")
setnames(dat_orignal,old= "Behaalde Diplomaâ€™s (selecteer alles dat van toepassing is) - Selected Choice", new= "Degree")
dat_orignal <- subset(dat_orignal,dat_orignal$Progress>=49) # to only add participants who finished atleast 1 scenario
dat_orignal$participants <- seq(1,330,1)
names(dat_orignal)[29:46] <- c("x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x11","x12","x13","x14","x15","x16","x17","x18")
dat_orignal <- dat_orignal %>%
mutate_at(c("x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x11","x12","x13","x14","x15","x16","x17","x18"), ~replace_na(., 12)) # this is to make the option "never" in analyzable variable.
dat_orignal <- dat_orignal %>%
mutate(Occupation = case_when(Occupation == "Rechter"  ~ "Judge",
Occupation == "(substituut) Procureur des konings/officier van justitie"  ~ "Prosecutor",
Occupation == "Advocaat"  ~ "Lawyer",
Occupation == "Jurist"  ~ "Parelegal",
TRUE  ~ "Other"))
dat_orignal <- dat_orignal %>%
mutate(Background = case_when(Background == "Civiel recht\r\n"  ~ "Civil law",
Background == "Strafrecht"  ~ "Criminal law",
TRUE  ~ "Other"))
dat_orignal <- dat_orignal %>%
mutate(group1 = case_when(x1 < 2.5 ~ "Low",
x1 >=2.5 & x1 <5.0 ~ "Medium-low",
x1 >=5.0 & x1 <7.5 ~ "Medium-high",
x1 >= 7.5 & x1 <=10~ "High",
x1 > 10 ~ "Never"))
dat_orignal <- dat_orignal %>%
mutate(group2 = case_when(x7 < 2.5 ~ "Low",
x7 >=2.5 & x7 <5.0 ~ "Medium-low",
x7 >=5.0 & x7 <7.5 ~ "Medium-high",
x7 >= 7.5 & x7 <=10~ "High",
x7 > 10 ~ "Never"))
dat_orignal <- dat_orignal %>%
mutate(group3 = case_when(x13 < 2.5 ~ "Low",
x13 >=2.5 & x13 <5.0 ~ "Medium-low",
x13 >=5.0 & x13 <7.5 ~ "Medium-high",
x13 >= 7.5 & x13 <=10~ "High",
x13 > 10 ~ "Never"))
dat_orignal <- dat_orignal %>%
mutate(Country = case_when(`List of Countries...28` == "Netherlands" ~ "NL",
`List of Countries...28`  == "Belgium" ~ "BE",
`List of Countries...28`  == "United States of America" ~ "USA",
TRUE ~ "Other"))
dat_orignal$group1  = factor(dat_orignal$group1, levels=c("Low", "Medium-low", "Medium-high", "High", "Never"))
dat_orignal$group2  = factor(dat_orignal$group2, levels=c("Low", "Medium-low", "Medium-high", "High", "Never"))
dat_orignal$group3  = factor(dat_orignal$group3, levels=c("Low", "Medium-low", "Medium-high", "High", "Never"))
dat_orignal$Occupation  = factor(dat_orignal$Occupation, levels=c("Judge", "Prosecutor", "Lawyer", "Parelegal", "Other"))
dat_exclusion <- dat_orignal
# First remove all participants that do not practive law in Belgium or the Netherlands
dat_exclusion <- subset(dat_exclusion, dat_exclusion$Country=="NL" | dat_exclusion$Country =="BE")
#Exclusions strict
dat_exclusion <- subset(dat_exclusion, dat_exclusion$`Leeftijd (in jaren)`- dat_exclusion$`Hoeveel jaren werkt u ongeveer al in het rechtssysteem?` > 18)
dat_exclusion <- subset(dat_exclusion,!(dat_exclusion$`Hoeveel jaren werkt u ongeveer al in het rechtssysteem?` < 5 & dat_exclusion$Occupation=="Judge"))
dat_exclusion <- subset(dat_exclusion, dat_exclusion$`Duration (in seconds)` > 300)
set.seed(2794)
# Extract variables
mlm_df1 <- subset(ave_dat, select = c("participants", "Country", "x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x11","x12","x13","x14","x15","x16","x17","x18"))
ave_dat <- dat_exclusion
ave_dat <- ave_dat %>%
mutate_at(c("x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x11","x12","x13","x14","x15","x16","x17","x18"), ~  na_if(.,12))# this is to convert the "never" values back to NA's. to get unbiased estimates
scen1 <- c(ave_dat$x1,ave_dat$x2,ave_dat$x3,ave_dat$x4,ave_dat$x5,ave_dat$x6)
scen2 <- c(ave_dat$x7,ave_dat$x8,ave_dat$x9,ave_dat$x10,ave_dat$x11,ave_dat$x12)
scen3 <- c(ave_dat$x13,ave_dat$x14,ave_dat$x15,ave_dat$x16,ave_dat$x17,ave_dat$x18)
averages <- cbind(scen1,scen2,scen3)
averages <- describe(averages)
library(psych)
ave_dat <- dat_exclusion
ave_dat <- ave_dat %>%
mutate_at(c("x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x11","x12","x13","x14","x15","x16","x17","x18"), ~  na_if(.,12))# this is to convert the "never" values back to NA's. to get unbiased estimates
scen1 <- c(ave_dat$x1,ave_dat$x2,ave_dat$x3,ave_dat$x4,ave_dat$x5,ave_dat$x6)
scen2 <- c(ave_dat$x7,ave_dat$x8,ave_dat$x9,ave_dat$x10,ave_dat$x11,ave_dat$x12)
scen3 <- c(ave_dat$x13,ave_dat$x14,ave_dat$x15,ave_dat$x16,ave_dat$x17,ave_dat$x18)
averages <- cbind(scen1,scen2,scen3)
averages <- describe(averages)
averages <- cbind(averages$vars,averages$n,averages$mean,averages$sd,averages$median)
averages <- as.data.frame(averages)
averages <- setnames(averages,old = c(1:5), new = c("Scenario","N","Mean","SD","Median"))
averages$Scenario <-  c("Scenario 1", "Scenario 2", "Scenario 3")
averages$Never <- nrow(ave_dat)*6-averages$N # participants times 6 to get total amount of respones possible
overall_ave<-nice_table(averages,
title = "Summary Statistics for each Scenario",
note = "Questions 1-6 belong to scenario 1, 7-12 to scenario 2, 13-18 belong to scenario 3")
ave_dat <- dat_exclusion
ave_dat <- ave_dat %>%
mutate_at(c("x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x11","x12","x13","x14","x15","x16","x17","x18"), ~  na_if(.,12))# this is to convert the "never" values back to NA's. to get unbiased estimates
scen1 <- c(ave_dat$x1,ave_dat$x2,ave_dat$x3,ave_dat$x4,ave_dat$x5,ave_dat$x6)
scen2 <- c(ave_dat$x7,ave_dat$x8,ave_dat$x9,ave_dat$x10,ave_dat$x11,ave_dat$x12)
scen3 <- c(ave_dat$x13,ave_dat$x14,ave_dat$x15,ave_dat$x16,ave_dat$x17,ave_dat$x18)
averages <- cbind(scen1,scen2,scen3)
averages <- describe(averages)
averages <- cbind(averages$vars,averages$n,averages$mean,averages$sd,averages$median)
averages <- as.data.frame(averages)
averages <- setnames(averages,old = c(1:5), new = c("Scenario","N","Mean","SD","Median"))
averages$Scenario <-  c("Scenario 1", "Scenario 2", "Scenario 3")
averages$Never <- nrow(ave_dat)*6-averages$N # participants times 6 to get total amount of respones possible
set.seed(2794)
# Extract variables
mlm_df1 <- subset(ave_dat, select = c("participants", "Country", "x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x11","x12","x13","x14","x15","x16","x17","x18"))
# Convert to long format
mlm_df1_long <- mlm_df1 %>%
pivot_longer(
cols = c("x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x11","x12","x13","x14","x15","x16","x17","x18"),
names_to = "Questions",
values_to = "Memory_errors")
# Create grouping variable for scenario
mlm_df1_long <- mlm_df1_long %>%
mutate(Scenario = ifelse(Questions == "x1", "scen1",
ifelse(Questions == "x2", "scen1",
ifelse(Questions == "x3", "scen1",
ifelse(Questions == "x4", "scen1",
ifelse(Questions == "x5", "scen1",
ifelse(Questions == "x6", "scen1",
ifelse(Questions == "x7", "scen2",
ifelse(Questions == "x8", "scen2",
ifelse(Questions == "x9", "scen2",
ifelse(Questions == "x10", "scen2",
ifelse(Questions == "x11", "scen2",
ifelse(Questions == "x12", "scen2",
"scen3")))))))))))))
# Set scenario 1 as factor and reference group
mlm_df1_long$Scenario <- as.factor(mlm_df1_long$Scenario)
mlm_df1_long$Scenario  <- relevel(mlm_df1_long$Scenario , ref = "scen2")
# Baseline model
model_base <- lmer(data= mlm_df1_long, Memory_errors ~ 1 + (1|participants), REML = F)
library(lme4)
# Baseline model
model_base <- lmer(data= mlm_df1_long, Memory_errors ~ 1 + (1|participants), REML = F)
summary(model_base)
library(flexplot)
visualize(model_base)
# Baseline model
model_base <- lmer(data= mlm_df1_long, Memory_errors ~ 1 + (Scenario|participants), REML = F)
summary(model_base)
visualize(model_base)
visualize(model_base, sample=20)
summary(model_base)
visualize(model_base, sample=20)
# Baseline model
model_base <- lmer(data= mlm_df1_long, Memory_errors ~ 1 + (Scenario|participants), REML = F)
summary(model_base)
# Baseline model
model_base <- lmer(data= mlm_df1_long, Memory_errors ~ scenario + (Scenario|participants), REML = F)
# Baseline model
model_base <- lmer(data= mlm_df1_long, Memory_errors ~ Scenario + (Scenario|participants), REML = F)
summary(model_base)
visualize(model_base, sample=20)
library(glmmTMB)
install.packages("glmmTMB")
library(glmmTMB)
glmmTMB(data= mlm_df1_long, Memory_errors ~ Scenario + (Scenario|participants))
?glmmTMB
glmmTMB(data= mlm_df1_long, Memory_errors ~ Scenario + (Scenario|participants), family = NegBinomial)
glmmTMB(data= mlm_df1_long, Memory_errors ~ Scenario + (Scenario|participants), family = nbinom2)
dat_orignal$participants <- seq(1,330,1)
dat_original <- dat_original %>%
rename_with(
~ paste0("x", 1:18),
.cols = 29:46
)
library(readxl)
library(dplyr)
library(tidyr)
library(lme4)
library(data.table)
dat_original <- read_xlsx("Raw_Data.xlsx", skip = 1)
dat_original <- as.data.frame(dat_original)
View(dat_original)
head(dat_original)
dat_original$participants <- seq(1,330,1)
library(readxl)
library(dplyr)
library(tidyr)
library(lme4)
library(data.table)
dat_original <- read_xlsx("Raw_Data.xlsx", skip = 1)
dat_original <- as.data.frame(dat_original)
View(dat_original)
head(dat_original)
dat_original$participants <- seq(1,nrow(dat_orignal),1)
dat_original$participants <- seq(1,nrow(dat_original),1)
dat_original <- dat_original %>%
rename_with(
~ paste0("x", 1:18),
.cols = 29:46
)
View(dat_original)
dat_analysis <- dat_original %>%
rename_with(
~ paste0("x", 1:18),
.cols = 29:46
)
dat_analysis <- dat_analysis %>%
mutate_at(c("x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x11","x12","x13","x14","x15","x16","x17","x18"), ~replace_na(., 12)) # this is to make the option "never" in analyzable variable.
dat_analysis <- dat_original %>%
filter(Progress >= 49)
dat_analysis <- dat_analysis %>%
filter(Country %in% c("NL", "BE"))
dat_original$participants <- seq(1,nrow(dat_original),1)
dat_analysis <- dat_original %>%
rename_with(
~ paste0("x", 1:18),
.cols = 29:46
)
dat_analysis <- dat_analysis %>%
mutate(Country = case_when(`List of Countries...28` == "Netherlands" ~ "NL",
`List of Countries...28`  == "Belgium" ~ "BE",
`List of Countries...28`  == "United States of America" ~ "USA",
TRUE ~ "Other"))
dat_analysis <- dat_analysis %>%
mutate_at(c("x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x11","x12","x13","x14","x15","x16","x17","x18"), ~replace_na(., 12)) # this is to make the option "never" in analyzable variable.
dat_analysis <- dat_original %>%
filter(Progress >= 49)
dat_analysis <- dat_analysis %>%
filter(Country %in% c("NL", "BE"))
dat_analysis <- dat_analysis %>%
mutate(Country = case_when(`List of Countries...28` == "Netherlands" ~ "NL",
`List of Countries...28`  == "Belgium" ~ "BE",
`List of Countries...28`  == "United States of America" ~ "USA",
TRUE ~ "Other"))
View(dat_analysis)
dat_analysis <- dat_analysis %>%
filter(Country %in% c("NL", "BE"))
dat_analysis <- dat_analysis %>%
filter(`Leeftijd (in jaren)` - `Hoeveel jaren werkt u ongeveer al in het rechtssysteem?` > 18)
dat_analysis <- dat_analysis %>%
filter(!(Occupation == "Judge" & `Hoeveel jaren werkt u ongeveer al in het rechtssysteem?` < 5))
dat_analysis <- dat_analysis %>%
filter(!(Occupation == "Rechter" & `Hoeveel jaren werkt u ongeveer al in het rechtssysteem?` < 5))
setnames(dat_orignal, old = "Wat is uw huidige beroep? - Selected Choice", new =  "Occupation")
setnames(dat_analysis, old = "Wat is uw huidige beroep? - Selected Choice", new =  "Occupation")
dat_analysis <- dat_analysis %>%
filter(!(Occupation == "Rechter" & `Hoeveel jaren werkt u ongeveer al in het rechtssysteem?` < 5))
dat_analysis <- dat_analysis %>%
filter(`Duration (in seconds)` > 300)
nrow(dat_analysis)
df_analysis_final <- df_analysis %>%
select(
participants,
Country,
starts_with("x")
)
dat_analysis_final <- dat_analysis %>%
select(
participants,
Country,
starts_with("x")
)
dat_analysis_final
mlm_df1_long <- mlm_df1 %>%
pivot_longer(
cols = select(starts_with(x)),
names_to = "Questions",
values_to = "Memory_errors")
dat_mlm <- dat_analysis_final %>%
pivot_longer(
cols = select(starts_with(x)),
names_to = "Questions",
values_to = "Memory_errors")
dat_mlm <- dat_analysis_final %>%
pivot_longer(
cols = select(starts_with("x")),
names_to = "Questions",
values_to = "Memory_errors")
dat_mlm <- df_analysis_final %>%
pivot_longer(
cols = starts_with("x"),
names_to = "Questions",
values_to = "Memory_errors"
)
dat_mlm <- dat_analysis_final %>%
pivot_longer(
cols = starts_with("x"),
names_to = "Questions",
values_to = "Memory_errors"
)
dat_analysis_wide <- dat_analysis %>%
select(
participants,
Country,
starts_with("x")
)
head(dat_analysis_wide)
dat_analysis_long <- dat_analysis_final %>%
pivot_longer(
cols = starts_with("x"),
names_to = "Questions",
values_to = "Memory_errors"
)
# Create grouping variable for scenario
dat_analysis_long <- dat_analysis_long %>%
mutate(Scenario = ifelse(Questions == "x1", "scen1",
ifelse(Questions == "x2", "scen1",
ifelse(Questions == "x3", "scen1",
ifelse(Questions == "x4", "scen1",
ifelse(Questions == "x5", "scen1",
ifelse(Questions == "x6", "scen1",
ifelse(Questions == "x7", "scen2",
ifelse(Questions == "x8", "scen2",
ifelse(Questions == "x9", "scen2",
ifelse(Questions == "x10", "scen2",
ifelse(Questions == "x11", "scen2",
ifelse(Questions == "x12", "scen2",
"scen3")))))))))))))
## Set scenario as factor and set reference group
dat_analysis_long <- dat_analysis_final %>%
pivot_longer(
cols = starts_with("x"),
names_to = "Questions",
values_to = "Memory_errors"
)
# Create grouping variable for scenario
dat_analysis_long <- dat_analysis_long %>%
mutate(Scenario = ifelse(Questions == "x1", "scen1",
ifelse(Questions == "x2", "scen1",
ifelse(Questions == "x3", "scen1",
ifelse(Questions == "x4", "scen1",
ifelse(Questions == "x5", "scen1",
ifelse(Questions == "x6", "scen1",
ifelse(Questions == "x7", "scen2",
ifelse(Questions == "x8", "scen2",
ifelse(Questions == "x9", "scen2",
ifelse(Questions == "x10", "scen2",
ifelse(Questions == "x11", "scen2",
ifelse(Questions == "x12", "scen2",
"scen3")))))))))))))
mlm_df1_long$Scenario <- as.factor(mlm_df1_long$Scenario)
library(ggplot2)
ggplot(mlm_df, aes(x = Scenario, y = memory_errors)) +   geom_jitter(width = 0.15, alpha = 0.3) +   theme_minimal() +   labs(y = "Memory Errors", x = NULL)
ggplot(dat_analysis_long, aes(x = Scenario, y = memory_errors)) +   geom_jitter(width = 0.15, alpha = 0.3) +   theme_minimal() +   labs(y = "Memory Errors", x = NULL)
ggplot(dat_analysis_long, aes(x = Scenario, y = Memory_errors)) +   geom_jitter(width = 0.15, alpha = 0.3) +   theme_minimal() +   labs(y = "Memory Errors", x = NULL)
ggplot(dat_analysis_long, aes(x = Scenario, y = Memory_errors)) +
geom_jitter(width = 0.15, alpha = 0.3) +   theme_minimal() +
labs(y = "Memory Errors", x = NULL) +
theme_classic
ggplot(dat_analysis_long, aes(x = Scenario, y = Memory_errors)) +
geom_jitter(width = 0.15, alpha = 0.3) +   theme_minimal() +
labs(y = "Memory Errors", x = NULL) +
theme_classic()
model_base <- lmer(memory_errors ~ Scenario + (Scenario | participants),
data = dat_analysis_long)
model_base <- lmer(Memory_errors ~ Scenario + (Scenario | participants),
data = dat_analysis_long)
ggplot(dat_analysis_long, aes(x = Scenario, y = Memory_errors, group = participants)) +
# Individual participant trajectories (random slopes)
geom_line(alpha = 0.3, color = "steelblue") +
# Individual data points
geom_point(alpha = 0.5, size = 2) +
# Overlay average trend (fixed effect)
stat_summary(aes(group = 1), fun = mean, geom = "line", color = "red", size = 1.5) +
stat_summary(aes(group = 1), fun = mean, geom = "point", color = "red", size = 3) +
theme_classic() +
labs(
y = "Memory Errors",
x = NULL,
title = "Memory Errors Across Scenarios",
subtitle = "Blue lines: individual participants (random slopes/intercepts)\nRed line: group mean (fixed effect)"
)
model_base <- lmer(Memory_errors ~ Scenario + (Scenario | participants),
data = dat_analysis_long)
model1 <- lmer(Memory_errors ~ Scenario + (Scenario | participants),
data = dat_analysis_long)
summary(model1)
visualize(model1)
visualize(model1,
sample = 69)
View(dat_original)
library(readxl)
library(dplyr)
library(tidyr)
library(lme4)
library(data.table)
library(ggplot2)
dat_original <- read_xlsx("Raw_Data.xlsx", skip = 1)
dat_original <- as.data.frame(dat_original)
dat_original$participants <- seq(1,nrow(dat_original),1)
dat_analysis <- dat_original %>%
rename_with(
~ paste0("x", 1:18),
.cols = 29:46
)
dat_analysis <- dat_analysis %>%
mutate(Country = case_when(`List of Countries...28` == "Netherlands" ~ "NL",
`List of Countries...28`  == "Belgium" ~ "BE",
`List of Countries...28`  == "United States of America" ~ "USA",
TRUE ~ "Other"))
setnames(dat_analysis, old = "Wat is uw huidige beroep? - Selected Choice", new =  "Occupation")
dat_analysis <- dat_analysis %>%
mutate_at(c("x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x11","x12","x13","x14","x15","x16","x17","x18"), ~replace_na(., 12)) # this is to make the option "never" in analyzable variable.
dat_analysis <- dat_original %>%
filter(Progress >= 49)
dat_analysis <- dat_analysis %>%
filter(Country %in% c("NL", "BE"))
View(dat_analysis)
library(sandwich)
library(gee)
lm_model <- lm(Memory_errors ~ Scenario, data = dat_analysis_long)
library(readxl)
library(dplyr)
library(tidyr)
library(lme4)
library(data.table)
library(ggplot2)
library(flexplot)
library(sandwich)
library(gee)
dat_original <- read_xlsx("Raw_Data.xlsx", skip = 1)
dat_original <- as.data.frame(dat_original)
View(dat_original)
head(dat_original)
dat_original$participants <- seq(1,nrow(dat_original),1)
dat_analysis <- dat_original %>%
rename_with(
~ paste0("x", 1:18),
.cols = 29:46
)
dat_analysis <- dat_analysis %>%
mutate(Country = case_when(`List of Countries...28` == "Netherlands" ~ "NL",
`List of Countries...28`  == "Belgium" ~ "BE",
`List of Countries...28`  == "United States of America" ~ "USA",
TRUE ~ "Other"))
setnames(dat_analysis, old = "Wat is uw huidige beroep? - Selected Choice", new =  "Occupation")
dat_analysis <- dat_analysis %>%
mutate_at(c("x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x11","x12","x13","x14","x15","x16","x17","x18"), ~replace_na(., 12)) # this is to make the option "never" in analyzable variable.
dat_analysis <- dat_analysis %>%
filter(Progress >= 49)
dat_analysis <- dat_analysis %>%
filter(Country %in% c("NL", "BE"))
dat_analysis <- dat_analysis %>%
filter(`Leeftijd (in jaren)` - `Hoeveel jaren werkt u ongeveer al in het rechtssysteem?` > 18)
dat_analysis <- dat_analysis %>%
filter(!(Occupation == "Rechter" & `Hoeveel jaren werkt u ongeveer al in het rechtssysteem?` < 5))
dat_analysis <- dat_analysis %>%
filter(`Duration (in seconds)` > 300)
nrow(dat_analysis)
dat_analysis_wide <- dat_analysis %>%
select(
participants,
Country,
starts_with("x")
)
head(dat_analysis_wide)
dat_analysis_long <- dat_analysis_wide %>%
pivot_longer(
cols = starts_with("x"),
names_to = "Questions",
values_to = "Memory_errors"
)
# Create grouping variable for scenario
dat_analysis_long <- dat_analysis_long %>%
mutate(Scenario = ifelse(Questions == "x1", "scen1",
ifelse(Questions == "x2", "scen1",
ifelse(Questions == "x3", "scen1",
ifelse(Questions == "x4", "scen1",
ifelse(Questions == "x5", "scen1",
ifelse(Questions == "x6", "scen1",
ifelse(Questions == "x7", "scen2",
ifelse(Questions == "x8", "scen2",
ifelse(Questions == "x9", "scen2",
ifelse(Questions == "x10", "scen2",
ifelse(Questions == "x11", "scen2",
ifelse(Questions == "x12", "scen2",
"scen3")))))))))))))
dat_analysis_long$Scenario <- as.factor(dat_analysis_long$Scenario)
dat_analysis_long$Scenario  <- relevel(dat_analysis_long$Scenario , ref = "scen2")
ggplot(dat_analysis_long, aes(x = Scenario, y = Memory_errors)) +
geom_jitter(width = 0.15, alpha = 0.3) +   theme_minimal() +
labs(y = "Memory Errors", x = NULL) +
theme_classic()
ggplot(dat_analysis_long, aes(x = Scenario, y = Memory_errors, group = participants)) +
# Individual participant trajectories (random slopes)
geom_line(alpha = 0.3, color = "steelblue") +
# Individual data points
geom_point(alpha = 0.5, size = 2) +
# Overlay average trend (fixed effect)
stat_summary(aes(group = 1), fun = mean, geom = "line", color = "red", size = 1.5) +
stat_summary(aes(group = 1), fun = mean, geom = "point", color = "red", size = 3) +
theme_classic() +
labs(
y = "Memory Errors",
x = NULL,
title = "Memory Errors Across Scenarios",
subtitle = "Blue lines: individual participants (random slopes/intercepts)\nRed line: group mean (fixed effect)"
)
model1 <- lmer(Memory_errors ~ Scenario + (Scenario | participants),
data = dat_analysis_long)
summary(model1)
visualize(model1,
sample = 69)
lm_model <- lm(Memory_errors ~ Scenario, data = dat_analysis_long)
coeftest(lm_model, vcov = vcovCL(lm_model, cluster = ~participants))
library(lmtest)
lm_model <- lm(Memory_errors ~ Scenario, data = dat_analysis_long)
coeftest(lm_model, vcov = vcovCL(lm_model, cluster = ~participants))
summary(model1)
gee(formula = Memory_errors ~ Scenario,
id = participants,
data = dat_analysis_long,
family = gaussian,
corstr = "independence")
gee_outcome <- gee(formula = Memory_errors ~ Scenario,
id = participants,
data = dat_analysis_long,
family = gaussian,
corstr = "independence")
summary(gee_outcome)
quarto render
